result = [[{'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '149', 'teamID': 'BOS', 'yearID': '1939'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '144', 'teamID': 'BOS', 'yearID': '1940'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '143', 'teamID': 'BOS', 'yearID': '1941'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '150', 'teamID': 'BOS', 'yearID': '1942'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '150', 'teamID': 'BOS', 'yearID': '1946'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '156', 'teamID': 'BOS', 'yearID': '1947'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '137', 'teamID': 'BOS', 'yearID': '1948'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '155', 'teamID': 'BOS', 'yearID': '1949'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '89', 'teamID': 'BOS', 'yearID': '1950'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '148', 'teamID': 'BOS', 'yearID': '1951'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '6', 'teamID': 'BOS', 'yearID': '1952'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '37', 'teamID': 'BOS', 'yearID': '1953'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '117', 'teamID': 'BOS', 'yearID': '1954'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '98', 'teamID': 'BOS', 'yearID': '1955'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '136', 'teamID': 'BOS', 'yearID': '1956'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '132', 'teamID': 'BOS', 'yearID': '1957'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '129', 'teamID': 'BOS', 'yearID': '1958'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '103', 'teamID': 'BOS', 'yearID': '1959'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'G_all': '113', 'teamID': 'BOS', 'yearID': '1960'}, {'playerID': 'willitr01', 'nameLast': 'Williams', 'nameFirst': 'Trevor', 'birthCity': 'San Diego', 'G_all': '7', 'teamID': 'PIT', 'yearID': '2016'}, {'playerID': 'willitr01', 'nameLast': 'Williams', 'nameFirst': 'Trevor', 'birthCity': 'San Diego', 'G_all': '31', 'teamID': 'PIT', 'yearID': '2017'}], [{'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1939', 'H': '185', 'HR': '31', 'RBI': '145'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1940', 'H': '193', 'HR': '23', 'RBI': '113'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1941', 'H': '185', 'HR': '37', 'RBI': '120'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1942', 'H': '186', 'HR': '36', 'RBI': '137'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1946', 'H': '176', 'HR': '38', 'RBI': '123'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1947', 'H': '181', 'HR': '32', 'RBI': '114'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1948', 'H': '188', 'HR': '25', 'RBI': '127'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1949', 'H': '194', 'HR': '43', 'RBI': '159'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1950', 'H': '106', 'HR': '28', 'RBI': '97'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1951', 'H': '169', 'HR': '30', 'RBI': '126'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1952', 'H': '4', 'HR': '1', 'RBI': '3'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1953', 'H': '37', 'HR': '13', 'RBI': '34'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1954', 'H': '133', 'HR': '29', 'RBI': '89'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1955', 'H': '114', 'HR': '28', 'RBI': '83'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1956', 'H': '138', 'HR': '24', 'RBI': '82'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1957', 'H': '163', 'HR': '38', 'RBI': '87'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1958', 'H': '135', 'HR': '26', 'RBI': '85'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1959', 'H': '69', 'HR': '10', 'RBI': '43'}, {'playerID': 'willite01', 'nameLast': 'Williams', 'nameFirst': 'Ted', 'birthCity': 'San Diego', 'teamID': 'BOS', 'yearID': '1960', 'H': '98', 'HR': '29', 'RBI': '72'}, {'playerID': 'willitr01', 'nameLast': 'Williams', 'nameFirst': 'Trevor', 'birthCity': 'San Diego', 'teamID': 'PIT', 'yearID': '2016', 'H': '0', 'HR': '0', 'RBI': '1'}, {'playerID': 'willitr01', 'nameLast': 'Williams', 'nameFirst': 'Trevor', 'birthCity': 'San Diego', 'teamID': 'PIT', 'yearID': '2017', 'H': '2', 'HR': '0', 'RBI': '0'}]]
children = ["appearances", "batting"]
field_list = ['people.playerID', 'people.nameLast', 'people.nameFirst', 'people.birthCity', 'batting.teamID', 'batting.yearID', 'batting.H', 'batting.HR', 'batting.RBI', 'appearances.G_all', 'appearances.teamID', 'appearances.yearID']
referenced_table = "people"

def merge(result, field_list, children, referenced_table):
	match = {}
	for f in field_list:
		curr = f.split(".")
		match[curr[0]] = match.get(curr[0], []) + [curr[1]]


	test, ans = result[0], []


	for r in test:
		one_ans = {}
		for elem in match:
			one_ans[elem] = {}
			for s in match[elem]:
				if s not in r: 
					break
				one_ans[elem][s] = r[s]
		ans.append(one_ans)

	for elem in ans:
		for s in elem:
			if s != referenced_table:
				elem[s] = [elem[s]]


	one_result= {}
	for elem in ans:
		if "".join(elem[referenced_table].keys()) not in one_result:
			one_result["".join(elem[referenced_table].keys())] = elem
		else:
			for child in children:
				one_result["".join(elem[referenced_table].keys())][child].extend(elem[child])

	ans = []
	for elem in one_result:
		ans.append(one_result[elem])
	print(ans)


	for test in result[1:]:
		curr_ans = []
		for r in test:
			one_ans = {}
			for elem in match:
				one_ans[elem] = {}
				for s in match[elem]:
					if s not in r: 
						break
					one_ans[elem][s] = r[s]
			curr_ans.append(one_ans)

		for elem in curr_ans:
			for s in elem:
				if s != referenced_table:
					elem[s] = [elem[s]]

		one_result= {}
		for elem in curr_ans:
			if "".join(elem[referenced_table].keys()) not in one_result:
				one_result["".join(elem[referenced_table].keys())] = elem
			else:
				for child in children:
					one_result["".join(elem[referenced_table].keys())][child].extend(elem[child])

		curr_ans = []
		for elem in one_result:
			curr_ans.append(one_result[elem])


		for item in ans:
			for item2 in curr_ans:
				if item[referenced_table] == item2[referenced_table]:
					for elem in item:
						if elem == referenced_table:
							continue
						else:
							if item[elem] == [{}]:
								item[elem] = item2[elem]
							elif item2[elem] == [{}]:
								continue
							else: 
								item[elem].extend(item2[elem])

	return ans

















